---
lab:
    title: '自助密码重置'
    module: '模块 10 - 保护身份'
---

# 实验室：自助密码重置
  
本逻辑阵列模块中的所有任务都是从 Azure 门户执行的 

逻辑阵列模块文件：无

### 方案
  
Adatum Corporation 希望利用 Azure AD Premium 功能


### 目标
  
完成本实验室后，你将能够：

- 管理 Azure AD 用户和组

- 管理 Azure AD 集成的 SaaS 应用程序。


### 练习 1：请创建 Azure AD 用户和群组。

本次练习的主要任务如下：

1. 请创建一个新 Azure AD 租户。

1. 请激活 Azure AD Premium v2 试用版

1. 创建和配置 Azure AD 用户。

1. 将 Azure AD Premium v2 许可证分配给 Azure AD 用户

1. 管理 Azure AD 组成员。

1. 配置自助密码重置功能

1. 验证自助密码重置功能


#### 任务 1：请创建一个新 Azure AD 租户。

1. 从实验室虚拟机启动 Microsoft Edge，浏览到 Azure 门户 ([**http://portal.azure.com**](http://portal.azure.com))，然后使用 Microsoft 帐户登录，该帐户具有要在本实验室中使用的 Azure 订阅的所有者角色。

1. 在 Azure 门户中，导航到 **新建** 边栏选项卡。 

1. 从**新建** 边栏选项卡，搜索 Azure Marketplace **Azure Active Directory**。

1. 使用搜索结果列表导航到 **创建目录** 边栏选项卡。

1. 在 **创建目录** 边栏选项卡中，使用以下设置创建新的 Azure AD 租户： 

  - 组织名称：**AdatumLab100-4d**

  - 初始域名：由字母和数字组合组成的唯一名称。 

  - 国家或地区：**美国**

   > **注意**：请记录初始域名。在本逻辑阵列模块中，您后续将需要该域名。 


#### 任务 2：请激活 Azure AD Premium v2 试用版

1. 在 Azure 门户中，将 **“目录+订阅筛选器”** 设置为新创建的“ Azure AD 租户”。

   > **注意**：**目录 + 订阅** 筛选器显示在 Azure 门户工具栏中的“Cloud Shell”图标右侧 

   > **注意**：如果 **AdatumLab100-5b** 条目未出现在 **目录 + 订阅** 筛选器列表中，则可能需要刷新浏览器窗口。

1. 在 Azure 门户中，导航到 **AdatumLab100-5b  - 概述** 边栏选项卡。

1. 从 **AdatumLab100-5b  - 概述** 边栏选项卡，导航到 **许可证 - 概述** 边栏选项卡。

1. 从 **许可证 - 概述** 边栏选项卡，导航至 **产品** 边栏选项卡。 

1. 从 **产品** 边栏选项卡，导航至 **启用** 边栏和启用 **Azure AD Premium P2** 免费试用版。


#### 任务 3：创建和配置 Azure AD 用户。

1. 在 Azure 门户中，导航到 AdatumLab100-5b Azure AD 租户的 **用户 - 所有用户** 边栏选项卡。

1. 在 **用户 - 所有用户** 边栏选项卡中，使用以下设置创建新用户：

    - 名称：**aaduser1**

    - 用户名：**aaduser1@&lt;DNS-domain-name&gt;.onmicrosoft.com**，其中&lt;DNS-domain-name&gt;表示您在本次练习的第一个任务中指定的初始域名。 

   > **注**：记下此用户名。本实验室稍后需要使用该用户名。

    - 个人资料： 

        - 部门：**销售**

    - 属性：**默认**

    - 组：**已选择 0 个组**

    - 目录角色：**用户**

    - 密码：选中 **显示密码** 复选框并记下 **密码** 文本框中出现的字符串。在本逻辑阵列模块中，您后续将需要该域名。

1. 在 **用户 - 所有用户** 边栏选项卡中，使用以下设置创建新用户：

    - 名称：**aaduser2**

    - 用户名：**aaduser2@&lt;DNS-domain-name&gt;.onmicrosoft.com**，其中&lt;DNS-domain-name&gt;表示您在本次练习的第一个任务中指定的初始域名。 

   > **注意**：记下此用户名。本实验室稍后需要使用该用户名。

    - 个人资料： 

        - 部门：**财务**

    - 属性：**默认**

    - 组：**已选择 0 个组**

    - 目录角色：**用户**

    - 密码：选择 **“显示密码”** 复选框并注意 **“密码”** 文本框中出现的字符串。在本逻辑阵列模块中，您后续将需要该域名。


#### 任务 4：将 Azure AD Premium v2 许可证分配给 Azure AD 用户。

   > **注**：要将 Azure AD Premium v2 许可证分配给 Azure AD 用户，首先必须设置其位置属性。

1. 在 **用户 - 所有用户** 边栏选项卡中，导航到 **aaduser1 - 配置文件** 边栏选项卡并将 **使用位置** 设置为 **美国**。

1. 从 **aaduser1  - 个人资料** 边栏选项卡，导航到 **aaduser1  - 许可证** 边栏选项卡并为用户分配 Azure Active Directory Premium P2 许可证，并启用所有许可选项。

1. 回到 **用户 - 所有用户** 边栏选项卡，导航到 **aaduser2  - 个人资料** 边栏选项卡，并设置 **使用位置** 至 **美国**。

1. 从 **aaduser2  - 个人资料** 边栏选项卡，导航到 **aaduser2  - 许可证** 边栏选项卡并为用户分配 Azure Active Directory Premium P2 许可证，并启用所有许可选项。

1. 回到 **用户 - 所有用户** 边栏选项卡，导航到您的用户帐户的个人资料条目并设置 **使用位置** 至 **美国**。

1. 导航您的用户帐户的 **许可证** 边栏选项卡，并为其分配 Azure Active Directory Premium P2 许可证，并启用所有许可选项。

1. 从门户网站注销，然后使用您在本逻辑阵列模块中使用的相同帐户重新登录。 

   > **注**：必须执行此步骤才能使许可证分配生效。 


#### 任务 5：管理 Azure AD 组成员。

1. 在 Azure 门户中，导航到 **群组 - 所有群组** 边栏选项卡。 

1. 从 **群组 - 所有群组** 边栏选项卡，导航到 **群组** 边栏选项卡并使用以下设置创建新组：

    - 组类型: **安全**

    - 组名：**销售**

    - 组说明：**销售部门中的所有用户**

    - 成员身份类型：**动态用户**

    - 动态用户成员： 

        - 简单的规则

        - 添加用户： **部门平均销售额**

1. 从 **群组 - 所有群组** 边栏选项卡，导航到 **群组** 边栏选项卡并使用以下设置创建新组：

    - 组类型:**安全**

    - 组名：**销售和财务**

    - 组说明：**销售和财务部门的所有用户**

    - 成员身份类型：**动态用户**

    - 动态用户成员： 

        - 高级规则：**(user.department -eq "Sales") - 或 (user.department -eq "Finance")**

1. 来自 **群组 - 所有群组** 边栏选项卡，导航到边栏选项卡 **销售** 和 **销售和财务** 组，并注意组成员资格评估正在进行中。等到评估完成，然后导航到 **成员** 边栏选项卡，并验证组成员身份是否正确。


#### 任务 6：配置自助密码重置功能

1. 在 Azure 门户中，导航到 **AdatumLab100-5b  - 概述** 边栏选项卡。 

1. 从 **AdatumLab100-5b  - 概述** 边栏选项卡，导航到 **密码重置 - 属性** 边栏选项卡。 

1. 在 **密码重置 - 属性** 边栏选项卡上，配置以下设置：

    - 自助密码重置 **Select**

    - 选择“组”。**销售**

1. 从 **密码重置 - 属性** 边栏选项卡，导航到 **密码重置 - 验证方法** 边栏选项卡并配置以下设置：

    - 重置所需的方法数：**1**

    - 用户可用的方法： 

        - **电子邮件**

        - **移动电话**

        - **办公室电话**

        - **安全问题**

        - 注册所需的安全问题数量：**3**

        - 重置所需的安全问题数量：**3**

        - 选择安全问题：选择 **预定义** 并添加 5 个预定义安全问题的任意组合

1. 从 **密码重置 - 身份验证方法** 边栏选项卡，导航到 **密码重置 - 注册** 边栏选项卡，并确保配置以下设置：

    - 要求用户在登录时注册？：**是**

    - 要求用户重新确认其身份验证信息的间隔天数：**180**


#### 任务 7：验证自助密码重置功能

1. 打开 InPrivate Microsoft Edge 窗口。

1. 在新的浏览器窗口中，导航到 Azure 门户并使用 **aaduser1** 用户帐户登录。出现提示时，将密码更改为新值。

   > **注意**：需要提供 **aaduser1** 用户帐户的完全限定名称，包括 Azure AD 租户 DNS 域名，如本实验室前面所述。

1. 系统提示 **需要更多信息** 消息时，继续访问 **请勿丢失对帐户的访问权限** 页面。

1. 在 **请勿丢失对帐户的访问权限** 页面，请注意需要至少设置以下某个选项：

    - **办公室电话**

    - **认证电话**

    - **身份验证电子邮件**

    - **安全问题**

1. 来自 **不要失去对您帐户的访问权限** 页面，配置您在上一个任务中选择的 5 个安全问题的答案

1. 验证您是否已成功登录 Azure 门户。

1. 注销 **aaduser1** 并关闭 InPrivate 浏览器窗口。

1. 打开 InPrivate Microsoft Edge 窗口。

1. 在新的浏览器窗口中，导航到 Azure 门户，然后在 **选一个帐户** 页面，输入 **aaduser1** 用户帐户名称。 

1. 在 **输入密码** 页面，单击 **忘记密码** 链接。

1. 在 **返回帐户** 页面，验证 **用户 ID**，输入图片中的字符或音频中的字词，然后继续访问下一页。

1. 在下一页中，使用您在上一个任务中指定的答案提供 thre 安全问题的答案。

1. 在下一页中，输入两次新密码并完成密码重置过程。

1. 验证您是否可以使用新重置的密码登录 Azure 门户。 

> **结果**：完成本次练习后，您已请创建一个新 Azure AD 租户。，激活 Azure AD Premium v2 试用版，创建和配置 Azure AD 用户，为 Azure AD 用户分配 Azure AD Premium v2 许可证，管理 Azure AD 组成员身份以及配置和验证的自助密码重置功能


### 练习 2：管理 Azure AD 集成的 SaaS 应用程序

本次练习的主要任务如下：

1. 从 Azure AD 库中添加应用程序

1. 配置应用程序以进行单一登录

1. 您可以定义每个角色的权限和分配给用户的角色。

1. 验证应用程序的单一登录方式


#### 任务 1：从 Azure AD 库中添加应用程序

1. 在 Azure 门户中，导航到 **AdatumLab100-5b  - 概述** 边栏选项卡。 

1. 从 **AdatumLab100-5b  - 概述** 边栏选项卡，导航到 **企业应用 - 所有应用** 边栏选项卡

1. 从 **企业应用 - 所有应用** 边栏选项卡，导航到 **添加应用程序** 边栏选项卡。 

1. 在 **添加应用程序** 边栏选项卡，搜索应用程序库 **Microsoft OneDrive**。 

1. 使用搜索结果列表导航到 **Microsoft OneDrive** 添加应用边栏选项卡并添加应用。


#### 任务 2：配置应用程序以进行单一登录

1. 从 **Microsoft OneDrive  - 概述** 边栏选项卡，导航到 **Microsoft OneDrive  - 入门** 边栏选项卡。 

1. 在 **Microsoft OneDrive  - 入门** 边栏选项卡，使用 **配置单点登录（必填）** 导航到的选项 **Microsoft OneDrive  - 单点登录** 边栏选项卡。 

1. 在 **Microsoft OneDrive  - 单一登录** 边栏选项卡，选择 **基于密码** 选项并保存配置。


#### 任务 3：您可以定义每个角色的权限和分配给用户的角色。

1. 导航回到 **Microsoft OneDrive  - 入门** 边栏选项卡。 

1. 在 **Microsoft OneDrive  - 入门** 边栏选项卡，使用 **分配用户进行测试（必需）** 导航到的选项 用于 **Microsoft OneDrive** 的 **用户和组** 边栏选项卡 。 

1. 从用于 **Microsoft OneDrive** 的 **用户和组** 边栏选项卡，导航到 **添加作业** 边栏选项卡并添加以下任务：

    - 用户和组：**销售和财务**

    - （请选择一个角色）：**默认访问权限**

    - 分配凭据： 

        - 分配要在所有组成员之间共享的凭据：**是**

        - 订阅：您希望用于本逻辑阵列模块的订阅名称。

        - 订阅：您希望用于本逻辑阵列模块的订阅名称。

1. 从 Azure 门户注销并关闭 Microsoft Edge 窗口。


#### 任务 4：验证应用程序的单一登录方式

1. 打开 Microsoft Edge 窗口。

1. 在 Microsoft Edge 窗口中，导航到位于的应用程序访问面板 [**HTTP：//myapps.microsoft.com**](http://myapps.microsoft.com) 并使用。登录 **aaduser2** 用户帐号。出现提示时，将密码更改为新值。

   > **注意**：需要提供 **aaduser2** 用户帐户的完全限定名称，包括 Azure AD 租户 DNS 域名，如本实验室前面所述。

1. 在“访问面板应用程序”页面上，单击 **Microsoft OneDrive** 图标。

1. 出现提示时，添加 My Apps Secure Sign-in Extension 并启用它，包括 **允许 InPrivate 浏览** 选项。

1. 再次导航到应用程序访问面板 [**HTTP：//myapps.microsoft.com**](http://myapps.microsoft.com) 并使用。登录 **aaduser2** 用户帐号。 

1. 在“访问面板应用程序”页面上，单击 **Microsoft OneDrive** 图标。

1. 验证您是否已成功访问 Microsoft OneDrive 应用程序，而无需重新进行身份验证。

1. 从应用程序访问面板注销并关闭 Microsoft Edge 窗口。

   > **注**：确保再次启动 Microsoft Edge，浏览到 Azure 门户，使用您在本逻辑阵列模块中使用的 Azure 订阅中具有所有者角色的 Microsoft 帐户登录，并使用 **目录订阅** 完成本逻辑阵列模块后，过滤以切换到默认的 Azure AD 租户。

> **结果**：完成本练习后，你已从 Azure AD 库中添加了应用程序，配置了应用程序以进行单一登录，为应用程序分配了用户，并验证了应用程序的单一登录方式。
