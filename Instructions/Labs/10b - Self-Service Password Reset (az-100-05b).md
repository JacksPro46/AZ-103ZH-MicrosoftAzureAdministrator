---
lab:
    title: '自助密码重置'
    module: '模块 10 - 保护标识'
---

# 实验：自助式密码重置
  
本实验中的所有任务都从 Azure 门户执行 

实验文件：无

### 方案
  
Adatum Corporation 希望利用 Azure AD Premium 功能


### 目标
  
完成本实验室后，你将能够：

- 管理 Azure AD 用户和组

- 管理集成了 Azure AD 的 SaaS 应用程序


### 练习 1：管理 Azure AD 用户和组

本练习的主要任务如下：

1. 创建新的 Azure AD 租户

1. 激活 Azure AD Premium v2 试用版

1. 创建和配置 Azure AD 用户

1. 将 Azure AD Premium v2 许可证分配给 Azure AD 用户

1. 管理 Azure AD 组成员身份

1. 配置自助式密码重置功能

1. 验证自助式密码重置功能


#### 任务 1：创建一个新 Azure AD 租户

1. 从实验虚拟机启动 Microsoft Edge，浏览到 Azure 门户 [**http://portal.azure.com**](http://portal.azure.com)，并使用在你打算用于本实验的 Azure 订阅中具有“所有者”角色的 Microsoft 帐户登录。

1. 在 Azure 门户中，导航到**“新建”**边栏选项卡。 

1. 从**“新建”**边栏选项卡，在 Azure 市场中搜索 **Azure Active Directory**。

1. 使用搜索结果列表，导航到**“创建目录”**边栏选项卡。

1. 从**“创建目录”**边栏选项卡，使用以下设置创建一个新的 Azure AD 租户： 

  - 组织名称：**AdatumLab100-5b**

  - 初始域名：由字母和数字组合组成的唯一名称。 

  - 国家或地区：**美国**

   > **备注**：记录初始域名。您将在本实验室后面需要它。 


#### 任务 2：激活 Azure AD Premium v2 试用版

1. 在 Azure 门户中，将**目录+订阅**筛选器设置为新创建的 Azure AD 租户。

   > **注**：该**“目录+订阅”**筛选器显示在 Azure 门户工具栏的“Cloud Shell”图标右侧 

   > **注**：如果 **AdatumLab100-5b** 条目没有显示在**“目录 + 订阅”**筛选器列表中，可能需要刷新浏览器窗口。

1. 在 Azure 门户中，导航到**“AdatumLab100-5b - 概述”**边栏选项卡。

1. 从**“AdatumLab100-5b - 概述”**边栏选项卡，导航到**“许可证 - 概述”**边栏选项卡。

1. 从**“许可证 - 概述”**边栏选项卡，导航到**“产品”**边栏选项卡。 

1. 从**“产品”**边栏选项卡，导航到**“激活”**边栏选项卡，并启用 **Azure AD Premium P2** 免费试用版。


#### 任务 3：创建和配置 Azure AD 用户。

1. 在 Azure 门户中，导航到 AdatumLab100-5b Azure AD 租户的**“用户 - 所有用户”**边栏选项卡。

1. 在**“用户 - 所有用户”**边栏选项卡中，使用以下设置创建新用户：

    - 名称：**aaduser1**

    - 用户名：**aaduser1@&lt;DNS-domain-name&gt;.onmicrosoft.com**，其中 &lt;DNS-domain-name&gt; 表示您在本次练习的第一个任务中指定的初始域名。 

   > **注**：记下此用户名。您将在本实验室后面需要它。

    - 个人资料： 

        - 部门：**销售**

    - 属性：**默认**

    - 群组：**选定了 0 个组**

    - 目录角色：**用户**

    - 密码：选中**显示密码**复选框并记下**密码**文本框中显示的字符串。您将在本实验室的后面需要它。

1. 在**“用户 - 所有用户”**边栏选项卡中，使用以下设置创建新用户：

    - 名称：**aaduser2**

    - 用户名：**aaduser2@&lt;DNS-domain-name&gt;.onmicrosoft.com**，其中 &lt;DNS-domain-name&gt; 表示您在本次练习的第一个任务中指定的初始域名。 

   > **注**：记下此用户名。您将在本实验室后面需要它。

    - 个人资料： 

        - 部门：**财务**

    - 属性：**默认**

    - 群组：**选定了 0 个组**

    - 目录角色：**用户**

    - 密码：选中**显示密码**复选框并记下**密码**文本框中显示的字符串。您将在本实验室的后面需要它。


#### 任务 4：将 Azure AD Premium v2 许可证分配给 Azure AD 用户

   > **备注**：要将 Azure AD Premium v2 许可证分配给 Azure AD 用户，首先必须设置其位置属性。

1. 从**用户 - 所有用户**边栏选项卡，导航到**aaduser1 - 个人资料**边栏选项卡，并将**使用位置**设置为**美国**。

1. 从**“aaduser1 - 个人资料”**边栏选项卡，导航到**“aaduser1 - 许可证”**边栏选项卡，向该用户分配 Azure Active Directory Premium P2 许可证，并启用所有许可选项。

1. 回到**“用户 - 所有用户”**边栏选项卡，导航到**“aaduser2 - 个人资料”**边栏选项卡，并将**“使用位置”**设置为**“美国”**。

1. 从**“aaduser2 - 个人资料”**边栏选项卡，导航到**“aaduser2 - 许可证”**边栏选项卡，向该用户分配 Azure Active Directory Premium P2 许可证，并启用所有许可选项。

1. 回到**“用户 - 所有用户”**边栏选项卡，导航到用户帐户的“个人资料”条目，并将**“使用位置”**设置为**“美国”**。

1. 导航到用户帐户的**“许可证”**边栏选项卡，为其分配 Azure Active Directory Premium P2 许可证，并启用所有许可选项。

1. 从门户注销，然后使用你在本实验中所用的帐户重新登录。 

   > **备注**：必须执行此步骤才能使许可证分配生效。 


#### 任务 5：管理 Azure AD 组成员身份。

1. 在 Azure 门户中，导航到**“组 - 所有组”**边栏选项卡。 

1. 从**“组 - 所有组”**边栏选项卡，导航到**“组”**边栏选项卡，并使用以下设置创建新组：

    - 组类型：**安全**

    - 组名：**销售**

    - 组描述：**销售部门中的所有用户**

    - 成员身份类型：**动态用户**

    - 动态用户成员： 

        - 简单规则

        - 在以下位置添加用户：部门等于**“销售”**

1. 从**“组 - 所有组”**边栏选项卡，导航到**“组”**边栏选项卡，并使用以下设置创建新组：

    - 组类型：**安全**

    - 组名：**销售和财务**

    - 组描述：**销售和财务部门的所有用户**

    - 成员身份类型：**动态用户**

    - 动态用户成员： 

        - 高级规则：**(user.department -eq "Sales") -or (user.department -eq "Finance")**

1. 从**“组 - 所有组”**边栏选项卡，导航到**“销售”**和**“销售和财务”**组的边栏选项卡，注意正在进行组成员身份评估。等到评估完成，然后导航到**“成员”**边栏选项卡，并验证组成员身份是否正确。


#### 任务 6：配置自助式密码重置功能

1. 在 Azure 门户中，导航到**“AdatumLab100-5b - 概述”**边栏选项卡。 

1. 从**“AdatumLab100-5b - 概述”**边栏选项卡，导航到**“密码重置 - 属性”**边栏选项卡。 

1. 在**“密码重置 - 属性”**边栏选项卡上，配置以下设置：

    - 已启用自助式密码重置：**已选择**

    - 已选择的组：**销售**

1. 从**“密码重置 - 属性”**边栏选项卡，导航到**“密码重置 - 身份验证方法”**边栏选项卡，并配置以下设置：

    - 需要重置的方法数：**1**

    - 用户可用的方法： 

        - **电子邮件**

        - **移动电话**

        - **办公电话**

        - **安全问题**

        - 注册所需的安全问题数：**3**

        - 重置所需的安全问题数：**3**

        - 选择安全问题：选择**“预定义”**并添加 5 个预定义安全问题的任意组合

1. 从**“密码重置 - 身份验证方法”**边栏选项卡，导航到**“密码重置 - 注册”**边栏选项卡，并确保配置以下设置：

    - 要求用户在登录时注册？：**是**

    - 在此天数后要求用户重新确认其身份验证信息：**180**


#### 任务 7：验证自助式密码重置功能

1. 打开 InPrivate Microsoft Edge 窗口。

1. 在新的浏览器窗口中，导航到 Azure 门户并使用**aaduser1**用户帐户登录。出现提示时，将密码更改为新值。

   > **备注**：需要提供 **aaduser1** 用户帐户的完全限定名称，包括 Azure AD 租户 DNS 域名，如本实验前面部分所述。

1. 当提示时**“需要更多信息”**消息时，继续到**“不丢失对你的帐户的访问权限”**页面。

1. 在**“不丢失对你的帐户的访问权限”**页面上，注意需要设置以下至少一个选项：

    - **办公电话**

    - **身份验证电话**

    - **身份验证电子邮件**

    - **安全问题**

1. 从**“不丢失对你的帐户的访问权限”**页面，配置你在上一个任务中选择的 5 个安全问题的答案

1. 验证是否已成功登录 Azure 门户。

1. 作为 **aaduser1** 注销，并关闭 InPrivate 浏览器窗口。

1. 打开 InPrivate Microsoft Edge 窗口。

1. 在新的浏览器窗口中，导航到 Azure 门户，然后在**“选取帐户”**页面键入 **aaduser1** 用户帐户名称。 

1. 在**输入密码**页面上，单击**忘记密码**链接。

1. 在**返回你的帐户**页面，验证**用户 ID**，输入图片中的字符或音频中的单词，然后继续到下一页。

1. 在下一页中，使用你在上一个任务中指定的答案回答安全问题。

1. 在下一页上，输入两次新密码并完成密码重置过程。

1. 验证你是否可以使用新重置的密码登录 Azure 门户。 

> **结果**：完成本次练习后，你创建了新的 Azure AD 租户，激活了 Azure AD Premium v2 试用版，创建并配置了 Azure AD 用户，向 Azure AD 用户分配了 Azure AD Premium v2 许可证，管理了 Azure AD 组成员身份，还配置并验证了自助式密码重置功能


### 练习 2：管理集成了 Azure AD 的 SaaS 应用程序

本练习的主要任务如下：

1. 从 Azure AD 库中添加应用程序

1. 为应用程序配置单一登录

1. 将用户分配到应用程序

1. 验证应用程序的单一登录


#### 任务 1：从 Azure AD 库中添加应用程序

1. 在 Azure 门户中，导航到**“AdatumLab100-5b - 概述”**边栏选项卡。 

1. 从**“AdatumLab100-5b - 概述”**边栏选项卡，导航到**“企业应用程序 - 所有应用程序”**边栏选项卡。

1. 从**“企业应用程序 - 所有应用程序”**边栏选项卡，导航到**“添加应用程序”**边栏选项卡。 

1. 在**“添加应用程序”**边栏选项卡上，在应用程序库中搜索 **Microsoft OneDrive**。 

1. 使用搜索结果列表，导航到**“Microsoft OneDrive”**边栏选项卡并添加应用。


#### 任务 2：为应用程序配置单一登录

1. 从**“Microsoft OneDrive - 概述”**边栏选项卡，导航到**“Microsoft OneDrive - 入门”**边栏选项卡。 

1. 在**“Microsoft OneDrive - 入门”**边栏选项卡中，使用**“配置单一登录(必需)”**选项导航到**“Microsoft OneDrive - 单一登录”**边栏选项卡。 

1. 在**“Microsoft OneDrive - 单一登录”**边栏选项卡上，选择**“基于密码”**选项并保存配置。


#### 任务 3：将用户分配到应用程序

1. 导航回到**“Microsoft OneDrive - 入门”**边栏选项卡。 

1. 在**“Microsoft OneDrive - 入门”**边栏选项卡上，使用**“分配用于测试的用户(必需)”**选项导航到 **Microsoft OneDrive** 的**“用户和组”**边栏选项卡。 

1. 从 **Microsoft OneDrive** 的**“用户和组”**边栏选项卡，导航到**“添加分配”**边栏选项卡并添加以下分配：

    - 用户和组：**销售和财务**

    - 选择角色：**默认访问权限**

    - 分配凭据： 

        - 分配要在所有组成员之间共享的凭据：**是**

        - 电子邮件地址：要用于本实验的 Microsoft 帐户的名称

        - 密码：要用于本实验的 Microsoft 帐户的密码

1. 从 Azure 门户注销，并关闭 Microsoft Edge 窗口。


#### 任务 4：验证应用程序的单一登录

1. 打开 Microsoft Edge 窗口。

1. 在 Microsoft Edge 窗口中，导航到应用程序访问面板 ([**http://myapps.microsoft.com**](http://myapps.microsoft.com))，并使用 **aaduser2** 用户帐户登录。出现提示时，将密码更改为新值。

   > **备注**：需要提供 **aaduser2** 用户帐户的完全限定的名称，包括 Azure AD 租户 DNS 域名，如本实验前面部分所述。

1. 在访问面板“应用程序”页面上，单击 **Microsoft OneDrive** 图标。

1. 出现提示时，添加我的应用安全登录扩展并启用它，包括**“允许 InPrivate 浏览”**选项。

1. 再次导航到应用程序访问面板 ([**http://myapps.microsoft.com**](http://myapps.microsoft.com))，并使用 **aaduser2** 用户帐户登录。 

1. 在访问面板“应用程序”页面上，单击 **Microsoft OneDrive** 图标。

1. 验证是否不需要重新进行身份验证而成功访问了 Microsoft OneDrive 应用程序。

1. 从应用程序访问面板注销，并关闭 Microsoft Edge 窗口。

   > **备注**：确保再次启动 Microsoft Edge，浏览到 Azure 门户，使用在本实验中所用 Azure 订阅中具有“所有者”角色的 Microsoft 帐户登录，并在完成实验后使用**“目录 + 订阅”**筛选器切换到默认 Azure AD 租户。

> **结果**：完成本练习后，你从 Azure AD 库中添加了应用程序，为应用程序配置了单一登录，向应用程序分配了用户，还验证了应用程序的单一登录。
